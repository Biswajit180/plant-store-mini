<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>GreenThumb - Minimal Plant Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{--accent:#2b9348;--muted:#666;--card:#fff;--bg:#f7f8f8}
    html,body,#root{height:100%}
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#222}
    .header{display:flex;align-items:center;justify-content:space-between;padding:12px 18px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,0.06);position:sticky;top:0;z-index:10}
    .brand{font-weight:700;color:var(--accent);font-size:18px}
    .nav a{margin:0 10px;text-decoration:none;color:#333}
    .nav a.active{font-weight:700;text-decoration:underline}
    .cart-btn{font-size:16px}
    .count{font-weight:700;margin-left:6px;color:var(--accent)}
    .main{max-width:1100px;margin:20px auto;padding:0 16px}
    .landing{display:flex;gap:20px;align-items:center;justify-content:center;padding:40px;background:linear-gradient(120deg, rgba(43,147,72,0.06), rgba(11,59,23,0.02));border-radius:10px}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,0.04)}
    .cta{background:var(--accent);color:#fff;padding:10px 14px;border-radius:8px;text-decoration:none;display:inline-block}
    .products .category{margin-bottom:22px}
    .grid{display:flex;gap:12px;flex-wrap:wrap}
    .plant{width:180px;text-align:center;background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,0.04)}
    .plant img{width:100%;height:110px;object-fit:cover;border-radius:8px}
    .plant button{margin-top:8px;padding:8px 10px;border-radius:8px;border:none;cursor:pointer;background:var(--accent);color:#fff}
    .plant button[disabled]{background:#ddd;color:#777;cursor:not-allowed}
    .cart-page .cart-item{display:flex;gap:12px;align-items:center;background:var(--card);padding:10px;border-radius:10px;margin-bottom:12px}
    .cart-item img{width:100px;height:70px;object-fit:cover;border-radius:6px}
    .qty button{padding:6px 10px;margin:0 6px}
    .delete-btn{background:#ff6b6b;color:#fff;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}
    .bottom-actions{display:flex;gap:12px;margin-top:12px}
    .btn{padding:8px 12px;border-radius:8px;background:#0b3b17;color:#fff;border:none;cursor:pointer;text-decoration:none;display:inline-block}
    footer{max-width:1100px;margin:40px auto;text-align:center;color:var(--muted)}
    @media (max-width:640px){.plant{width:48%}}
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React + ReactDOM (UMD) -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Redux + React-Redux (UMD) -->
  <script src="https://unpkg.com/redux@4.2.1/dist/redux.js"></script>
  <script src="https://unpkg.com/react-redux@8.1.2/dist/react-redux.js"></script>

  <!-- Babel (for JSX in-browser) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { createStore } = window.Redux;
    const { Provider, useSelector, useDispatch } = window.ReactRedux;
    const { useState, useEffect } = React;

    const PLANTS = [
      { id: "p1", name: "Aloe Vera", price: 199, img: "https://i.imgur.com/2QZ2YzP.jpg", category: "Succulents" },
      { id: "p2", name: "Snake Plant", price: 399, img: "https://i.imgur.com/8Km9tLL.jpg", category: "Air-Purifying" },
      { id: "p3", name: "ZZ Plant", price: 499, img: "https://i.imgur.com/yFf3k5Q.jpg", category: "Indoor" },
      { id: "p4", name: "Jade Plant", price: 299, img: "https://i.imgur.com/Js1b6iX.jpg", category: "Succulents" },
      { id: "p5", name: "Pothos", price: 249, img: "https://i.imgur.com/0ClfKX4.jpg", category: "Indoor" },
      { id: "p6", name: "Spider Plant", price: 179, img: "https://i.imgur.com/Rz6g7xz.jpg", category: "Air-Purifying" }
    ];

    const initialState = { items: {} };

    function cartReducer(state = initialState, action) {
      switch(action.type) {
        case "ADD": {
          const p = action.payload;
          if (state.items[p.id]) return state;
          return { ...state, items: { ...state.items, [p.id]: { ...p, qty: 1 } } };
        }
        case "INCREMENT": {
          const id = action.payload;
          const current = state.items[id];
          if (!current) return state;
          return { ...state, items: { ...state.items, [id]: { ...current, qty: current.qty + 1 } } };
        }
        case "DECREMENT": {
          const id = action.payload;
          const current = state.items[id];
          if (!current) return state;
          if (current.qty <= 1) {
            const copy = { ...state.items };
            delete copy[id];
            return { ...state, items: copy };
          }
          return { ...state, items: { ...state.items, [id]: { ...current, qty: current.qty - 1 } } };
        }
        case "REMOVE": {
          const id = action.payload;
          const copy = { ...state.items };
          delete copy[id];
          return { ...state, items: copy };
        }
        case "CLEAR": return initialState;
        default: return state;
      }
    }

    const store = createStore(cartReducer);

    function useHashRoute() {
      const [route, setRoute] = useState(location.hash.replace("#","") || "/");
      useEffect(() => {
        const onHash = () => setRoute(location.hash.replace("#","") || "/");
        window.addEventListener("hashchange", onHash);
        return () => window.removeEventListener("hashchange", onHash);
      }, []);
      return [route];
    }

    function Header() {
      const items = useSelector(s => s.items);
      const totalCount = Object.values(items).reduce((s, it) => s + it.qty, 0);
      const route = location.hash.replace("#","") || "/";
      return (
        <div className="header">
          <div className="brand">Green<span style={{color:"#0b3b17",marginLeft:6}}>Thumb</span></div>
          <nav className="nav">
            <a href="#/" className={route === "/" ? "active" : ""}>Home</a>
            <a href="#/products" className={route === "/products" ? "active" : ""}>Products</a>
            <a href="#/cart" className={route === "/cart" ? "active" : ""}>Cart</a>
          </nav>
          <div className="cart-btn">
            <a href="#/cart" style={{textDecoration:"none",color:"#333"}}>ðŸ›’<span className="count">{totalCount}</span></a>
          </div>
        </div>
      );
    }

    function Landing() {
      return (
        <section className="main">
          <div className="landing card" style={{width:"100%"}}>
            <div style={{maxWidth:760,textAlign:"center"}}>
              <h1 style={{margin:"6px 0"}}>GreenThumb</h1>
              <p style={{color:"var(--muted)"}}>Houseplants to brighten your room and purify your air. Curated, healthy, and affordable.</p>
              <a className="cta" href="#/products" style={{marginTop:12}}>Get Started</a>
            </div>
          </div>
        </section>
      );
    }

    function Products() {
      const dispatch = useDispatch();
      const items = useSelector(s => s.items);
      const categories = Array.from(new Set(PLANTS.map(p => p.category)));
      return (
        <section className="main products">
          <h2 style={{marginBottom:10}}>Plant Listing</h2>
          {categories.map(cat => (
            <div key={cat} className="category card" style={{padding:12,marginBottom:14}}>
              <h3 style={{marginTop:0}}>{cat}</h3>
              <div className="grid">
                {PLANTS.filter(p => p.category === cat).map(p => {
                  const disabled = !!items[p.id];
                  return (
                    <div key={p.id} className="plant">
                      <img src={p.img} alt={p.name}/>
                      <h4 style={{margin:"8px 0 4px"}}>{p.name}</h4>
                      <div style={{color:"var(--muted)"}}>â‚¹{p.price}</div>
                      <button disabled={disabled} onClick={() => dispatch({type:"ADD", payload:p})}>
                        {disabled ? "Added" : "Add to Cart"}
                      </button>
                    </div>
                  );
                })}
              </div>
            </div>
          ))}
        </section>
      );
    }

    function CartPage() {
      const items = useSelector(s => s.items);
      const arr = Object.values(items);
      const totalCount = arr.reduce((s,it)=>s+it.qty,0);
      const totalPrice = arr.reduce((s,it)=>s+it.qty*it.price,0);
      const dispatch = useDispatch();

      return (
        <section className="main cart-page">
          <h2>Shopping Cart</h2>
          <div style={{display:"flex",gap:20,alignItems:"center",marginBottom:12}}>
            <div className="card" style={{padding:10}}>
              <strong>Total items:</strong> {totalCount}
            </div>
            <div className="card" style={{padding:10}}>
              <strong>Total cost:</strong> â‚¹{totalPrice}
            </div>
          </div>

          {arr.length === 0 ? (
            <div className="card" style={{padding:16}}>
              <p>Your cart is empty.</p>
              <a className="btn" href="#/products">Continue Shopping</a>
            </div>
          ) : (
            <>
              <div>
                {arr.map(it => (
                  <div key={it.id} className="cart-item card">
                    <img src={it.img} alt={it.name}/>
                    <div style={{flex:1}}>
                      <h4 style={{margin:"6px 0"}}>{it.name}</h4>
                      <div style={{color:"var(--muted)"}}>Unit price: â‚¹{it.price}</div>
                      <div className="qty" style={{marginTop:8,display:"flex",alignItems:"center"}}>
                        <button onClick={() => dispatch({type:"DECREMENT", payload:it.id})}>-</button>
                        <div style={{minWidth:30,textAlign:"center"}}>{it.qty}</div>
                        <button onClick={() => dispatch({type:"INCREMENT", payload:it.id})}>+</button>
                      </div>
                    </div>
                    <div style={{textAlign:"right"}}>
                      <div style={{marginBottom:8}}>Subtotal: â‚¹{it.qty * it.price}</div>
                      <button className="delete-btn" onClick={() => dispatch({type:"REMOVE", payload:it.id})}>Delete</button>
                    </div>
                  </div>
                ))}
              </div>
              <div className="bottom-actions">
                <button className="btn" onClick={() => alert("Coming Soon")}>Checkout</button>
                <a className="btn" href="#/products">Continue Shopping</a>
              </div>
            </>
          )}
        </section>
      );
    }

    function AppRoot(){
      const [route] = useHashRoute();
      return (
        <>
          <Header />
          {route === "/" && <Landing />}
          {route === "/products" && <Products />}
          {route === "/cart" && <CartPage />}
          <footer style={{padding:20}}>Built for the Coursera peer-graded assignment.</footer>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(
      <Provider store={store}>
        <AppRoot />
      </Provider>
    );
  </script>
</body>
</html>
